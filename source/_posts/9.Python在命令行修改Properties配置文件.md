---
title: Pythonåœ¨å‘½ä»¤è¡Œä¿®æ”¹Propertiesé…ç½®æ–‡ä»¶
date: 2022-08-26 20:30:00
author: ChenyangGao
categories: è„šæœ¬å·¥å…·
tags: [Python, Script]
thumbnail: https://cdn.pixabay.com/photo/2014/08/15/21/40/snake-419043_640.jpg

---

## èƒŒæ™¯

æˆ‘åœ¨å¹³å¸¸çš„å·¥ä½œä¸­ï¼Œç»å¸¸éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚é…ç½®æ–‡ä»¶çš„æ ¼å¼å¤šç§å¤šæ ·ï¼Œæœ‰ä¸€ç§é…ç½®æ–‡ä»¶æœ€ä¸ºå¸¸è§ï¼Œå°±æ˜¯æ¯ä¸€è¡Œå½¢å¦‚ `name=value` æ ¼å¼ï¼Œä¾‹å¦‚ [Java Properties](https://docs.oracle.com/javase/8/docs/api/java/util/Properties.html)ã€‚åœ¨ç¼–å†™è¿™ä¸ªè„šæœ¬ä»¥å‰ï¼Œæˆ‘å¸¸å¸¸ç”¨ [sed](https://www.gnu.org/software/sed/manual/sed.html) å‘½ä»¤æ¥åšå¢åˆ æ”¹æŸ¥ï¼Œä¸è¿‡æˆ‘è§‰å¾—è¿™**å¹¶ä¸è¶³å¤Ÿæ–¹ä¾¿**ã€‚

äºæ˜¯æˆ‘ä¸“é—¨å†™äº†ä¸€ä¸ª `Python` å‘½ä»¤è¡Œå·¥å…·ï¼Œæ¥æ‰¹é‡å¢åˆ æ”¹æŸ¥ä¸Šè¿°æ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨æ—¶æ³¨æ„è¦ç»™ç”¨æˆ·å¯¹è¢«å¤„ç†çš„é…ç½®æ–‡ä»¶æˆäºˆå¿…è¦æƒé™ï¼Œæ¯”å¦‚ `r` å’Œ `w`ã€‚

<!--more-->

## ä»£ç å®ç°

> **TIPS** ä»£ç çš„æœ€æ–°ç‰ˆæœ¬åœ¨ [GitHub Gist](https://gist.github.com/ChenyangGao) ä¸­ç»´æŠ¤
> https://gist.github.com/ChenyangGao/41e33d761c1e532d5e0b89502bd21414

æ–‡ä»¶åç§°ä¸º `config_props.py`ï¼Œå®ç°å¦‚ä¸‹ï¼š

```python config_props.py
#!/usr/bin/env python3
# coding: utf-8

assert __name__ == "__main__", "ä¸èƒ½è¢«å¼•å…¥æ¨¡å—"

__author__ = "ChenyangGao <https://chenyanggao.github.io/>"
__version__ = (0, 1, 1)

from argparse import ArgumentParser, RawTextHelpFormatter
from sys import argv


parser = ArgumentParser(
    description="å¢åˆ æ”¹æŸ¥ç±»å¦‚ Java Properties æ ¼å¼çš„é…ç½®æ–‡ä»¶",
    epilog="ğŸ˜† å‹æƒ…æç¤ºï¼š\næ¯é¡¹ property éƒ½æ˜¯å•è¡Œçš„ï¼Œå¦‚æœè¦æ¢è¡Œï¼Œ"
           "è¯·åœ¨ä¸Šä¸€è¡Œçš„æœ«å°¾åŠ åæ–œæ ï¼ˆç»­è¡Œç¬¦ï¼‰\\",
    formatter_class=RawTextHelpFormatter,
)
subparsers = parser.add_subparsers(dest="command", help="Available commands")

parser_get = subparsers.add_parser(
    "get", formatter_class=RawTextHelpFormatter,
    help="è¯»å–é…ç½®ï¼šconfig_props.py get path name ...",
)
parser_get.add_argument("path", help="é…ç½®æ–‡ä»¶è·¯å¾„")
parser_get.add_argument(
    "patterns", metavar="pattern", nargs="+", help="å±æ€§åæˆ–æ¨¡å¼")
parser_get.add_argument(
    "-t", "--type", choices=("raw", "wild", "re"), default="raw",
    help="""å±æ€§åä½œä¸ºä»€ä¹ˆæ¨¡å¼å¤„ç†ï¼š
    raw(é»˜è®¤): è§†ä¸ºæ™®é€šå­—ç¬¦ä¸²ï¼›
    wild: è§†ä¸º unix é€šé…ç¬¦æ¨¡å¼ï¼›
    re: è§†ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ã€‚""",
)
parser_get.add_argument(
    "-s", "--sign", default="=", help="å±æ€§å’Œå€¼çš„åˆ†ç•Œï¼Œå¿…é¡»æ˜¯å•ä¸ªå­—ç¬¦ï¼Œé»˜è®¤ä¸º =",
)
parser_get.add_argument(
    "-e", "--encoding", help="é…ç½®æ–‡ä»¶çš„ç¼–ç ",
)


parser_set = subparsers.add_parser(
    "set", formatter_class=RawTextHelpFormatter,
    help="æ›´æ–°é…ç½®ï¼šconfig_props.py set path name value ...",
)
parser_set.add_argument("path", help="é…ç½®æ–‡ä»¶è·¯å¾„")
parser_set.add_argument(
    "pairs", metavar="name value", nargs="+",
    help="å±æ€§åå’Œå±æ€§å€¼çš„å¯¹å¶ï¼Œæ­¤å‚æ•°å¿…é¡»ä¼ å¶æ•°ä¸ª",
)
parser_set.add_argument(
    "-s", "--sign", default="=", help="å±æ€§å’Œå€¼çš„åˆ†ç•Œï¼Œå¿…é¡»æ˜¯å•ä¸ªå­—ç¬¦ï¼Œé»˜è®¤ä¸º =",
)
parser_set.add_argument(
    "-e", "--encoding", help="é…ç½®æ–‡ä»¶çš„ç¼–ç ",
)

parser_del = subparsers.add_parser(
    "del", formatter_class=RawTextHelpFormatter,
    help="åˆ é™¤é…ç½®ï¼šconfig_props.py del path name ...",
)
parser_del.add_argument("path", help="é…ç½®æ–‡ä»¶è·¯å¾„")
parser_del.add_argument("patterns", metavar="pattern", nargs="+", help="å±æ€§åæˆ–æ¨¡å¼")
parser_del.add_argument(
    "-t", "--type", choices=("raw", "wild", "re"), default="raw",
    help="""å±æ€§åä½œä¸ºä»€ä¹ˆæ¨¡å¼å¤„ç†ï¼š
    raw(é»˜è®¤): è§†ä¸ºæ™®é€šå­—ç¬¦ä¸²ï¼›
    wild: è§†ä¸º unix é€šé…ç¬¦æ¨¡å¼ï¼›
    re: è§†ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ã€‚""",
)
parser_del.add_argument(
    "-s", "--sign", default="=", help="å±æ€§å’Œå€¼çš„åˆ†ç•Œï¼Œå¿…é¡»æ˜¯å•ä¸ªå­—ç¬¦ï¼Œé»˜è®¤ä¸º =",
)
parser_del.add_argument(
    "-e", "--encoding", help="é…ç½®æ–‡ä»¶çš„ç¼–ç ",
)

parser_uplines = subparsers.add_parser(
    "uplines", formatter_class=RawTextHelpFormatter,
    help="æ›´æ–°é…ç½®ï¼šconfig_props.py uplines path name=value ...",
)
parser_uplines.add_argument("path", help="é…ç½®æ–‡ä»¶è·¯å¾„")
parser_uplines.add_argument(
    "lines", metavar="line", nargs="+",
    help="""å½¢å¦‚ï¼š
    1. name: åˆ é™¤åç§°æ˜¯nameçš„å±æ€§ï¼›
    2. name=value: æ›´æ–°åç§°æ˜¯nameçš„å±æ€§ã€‚""",
)
parser_uplines.add_argument(
    "-s", "--sign", default="=", help="å±æ€§å’Œå€¼çš„åˆ†ç•Œï¼Œå¿…é¡»æ˜¯å•ä¸ªå­—ç¬¦ï¼Œé»˜è®¤ä¸º =",
)
parser_uplines.add_argument(
    "-e", "--encoding", help="é…ç½®æ–‡ä»¶çš„ç¼–ç ",
)

# TODO: æ·»åŠ å‘½ä»¤ commentï¼Œå¢åˆ æ”¹å±æ€§ä¸Šé¢çš„æ³¨é‡Šï¼šconfig_props.py comment path name=value ...
# TODO: æ·»åŠ å‘½ä»¤ mergeï¼Œåˆå¹¶å¤šä¸ªé…ç½®æ–‡ä»¶ï¼šconfig_props.py merge path path2 ...

if len(argv) < 2 or argv[1] not in ("get", "set", "del", "uplines"):
    args = parser.parse_args(["-h"])
args = parser.parse_args()

sign = args.sign
assert len(sign) == 1, "å±æ€§åå’Œå€¼çš„åˆ†éš”ç¬¦ sign å¿…é¡»æ˜¯å•å­—ç¬¦ï¼Œæ¯”å¦‚ ="


import re


CRE_PROPLINE = re.compile(fr"^[\t ]*(?!#)(?P<name>[^{sign}\s]+)[\t ]*{sign}[\t ]*(?P<value>.*)", re.M)


class ConfigProps:
    """é…ç½®æ–‡ä»¶ç®¡ç†å™¨
    :param path: é…ç½®æ–‡ä»¶è·¯å¾„
    :param encoding: é…ç½®æ–‡ä»¶çš„ç¼–ç ï¼Œé»˜è®¤ä¸º Noneï¼Œå³æ ¹æ®ç³»ç»Ÿç»™å®š
    """
    def __init__(self, path, encoding=None):
        self._path = path
        self.encoding = encoding
        self.read()

    def __contains__(self, name):
        return name in self._map

    def __len__(self):
        return len(self._map)

    def __getitem__(self, name):
        return self._map[name]

    @property
    def path(self):
        "é…ç½®æ–‡ä»¶è·¯å¾„"
        return self._path

    def read(self):
        "ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–é…ç½®"
        try:
            self._lines = lines = open(self._path, "r", encoding=self.encoding).readlines()
        except FileNotFoundError:
            self._lines = []
            self._map = {}
            return
        if lines and not lines[-1].endswith("\n"):
            lines[-1] += "\n"

        self._map = map_ = {}
        for lineno, line in enumerate(lines):
            match = CRE_PROPLINE.search(line)
            if match is not None:
                map_[match["name"]] = [match["value"], lineno]

    def write(self):
        "æŠŠæœ€æ–°çš„é…ç½®å†™å…¥é…ç½®æ–‡ä»¶"
        open(self._path, "w", encoding=self.encoding).writelines(self._lines)

    def search(self, *pats, type="raw"):
        """ç”Ÿæˆå™¨ï¼Œä»é…ç½®æ–‡ä»¶ä¸­ç­›é€‰å±æ€§åç¬¦åˆä»»ä¸€æ¨¡å¼çš„å±æ€§è¡Œ

        :param pats: å±æ€§åçš„æ¨¡å¼
        :param type: ä»¥ä½•ç§æ¨¡å¼å¤„ç†ï¼š
            raw(é»˜è®¤): è§†ä¸ºæ™®é€šå­—ç¬¦ä¸²ï¼›
            wild: è§†ä¸º unix é€šé…ç¬¦æ¨¡å¼ï¼›
            re: è§†ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ã€‚

        :return: è¿­ä»£å™¨
        """
        lines, map_ = self._lines, self._map
        if not pats:
            return
        pats = frozenset(pats)
        if type == "raw":
            predicate = pats.__contains__
        elif type == "wild":
            from fnmatch import translate
            predicate = re.compile("|".join(map(translate, pats))).fullmatch
        elif type == "re":
            predicate = re.compile("|".join(f"(?:{pat})" for pat in pats)).fullmatch
        else:
            raise ValueError(f"Unacceptable type value: {type!r}")
        for name, (value, lineno) in map_.items():
            if predicate(name):
                yield name, value, lineno

    def select(self, *pats, type="raw"):
        lines = self._lines
        for _, _, lineno in self.search(*pats, type=type):
            print(lines[lineno].rstrip("\n"))

    def delete(self, *pats, type="raw"):
        lines, map_ = self._lines, self._map
        meets = tuple(self.search(*pats, type=type))
        t = tuple(map_.values())
        for n, (name, value, lineno) in enumerate(meets):
            line = lines[lineno-n]
            # åˆ é™¤ 1 è¡Œåï¼Œè¿™è¡Œåé¢çš„æ¯ 1 è¡Œåœ¨åˆ—è¡¨ä¸­çš„ç´¢å¼•ä¼š -1
            for e in t[lineno+1:]:
                e[1] -= 1
            del map_[name]
            del lines[lineno-n]
            print("Deleted:", name, "\n      <=", line.rstrip("\n"))
        return len(meets)

    def insert(self, name, value, line=None):
        lines, map_ = self._lines, self._map
        if line is None:
            line = f"{name}={value}\n"
        lines.append(line)
        map_[name] = (value, len(lines))
        print("Inserted:", name, "\n      =>", line.rstrip("\n"), "")

    def update(self, name, value, line=None):
        lines, map_ = self._lines, self._map
        if line is None:
            line = f"{name}={value}\n"
        lineno = map_[name][1]
        map_[name] = value, lineno
        line_old = lines[lineno]
        lines[lineno] = line
        print("Updated:", line_old.rstrip("\n"), "\n      =>", line.rstrip("\n"))

    def upsert(self, name, value, line=None):
        map_ = self._map
        if name in map_:
            self.update(name, value, line)
        else:
            self.insert(name, value, line)

    def update_lines(self, *lines):
        n = 0
        for line in lines:
            match = CRE_PROPLINE.search(line)
            if match is None:
                name = line
                if name in conf_props:
                    self.delete(name)
                else:
                    print("ğŸ˜‚ ignored:", name)
                    continue
            else:
                line += "\n"
                name, value = match["name"], match["value"]
                self.upsert(name, value, line)
            n += 1
        return n


command = args.command
path = args.path
encoding = args.encoding

conf_props = ConfigProps(path)

if command == "get":
    patterns = args.patterns
    type = args.type
    conf_props.select(*patterns, type=type)
elif command == "set":
    pairs = args.pairs
    names = pairs[::2]
    values = pairs[1::2]
    for name, value in zip(names, values):
        conf_props.upsert(name, value)
    if names and values:
        conf_props.write()
elif command == "del":
    patterns = args.patterns
    type = args.type
    if conf_props.delete(*patterns, type=type):
        conf_props.write()
elif command == "uplines":
    lines = args.lines
    if conf_props.update_lines(*lines):
        conf_props.write()
else:
    raise NotImplementedError


```

## ä½¿ç”¨è¯´æ˜

å‘½ä»¤å¸®åŠ©ä¿¡æ¯å¦‚ä¸‹ï¼š

```shell
$ python config_props.py -h
usage: config_props.py [-h] {get,set,del,uplines} ...

å¢åˆ æ”¹æŸ¥ç±»å¦‚ Java Properties æ ¼å¼çš„é…ç½®æ–‡ä»¶

positional arguments:
  {get,set,del,uplines}
                        Available commands
    get                 è¯»å–é…ç½®ï¼šconfig_props.py get path name ...
    set                 æ›´æ–°é…ç½®ï¼šconfig_props.py set path name value ...
    del                 åˆ é™¤é…ç½®ï¼šconfig_props.py del path name ...
    uplines             æ›´æ–°é…ç½®ï¼šconfig_props.py uplines path name=value ...

optional arguments:
  -h, --help            show this help message and exit

ğŸ˜† å‹æƒ…æç¤ºï¼š
æ¯é¡¹ property éƒ½æ˜¯å•è¡Œçš„ï¼Œå¦‚æœè¦æ¢è¡Œï¼Œè¯·åœ¨ä¸Šä¸€è¡Œçš„æœ«å°¾åŠ åæ–œæ ï¼ˆç»­è¡Œç¬¦ï¼‰\
```

ç°åœ¨å‡è®¾å¾…å¤„ç†çš„é…ç½®æ–‡ä»¶ `example.properties` çš„å†…å®¹å¦‚ä¸‹ï¼š

```ini example.properties
## ä»¥ä¸‹æ˜¯æ•°æ®åº“è¿æ¥ä¿¡æ¯

# æ•°æ®åº“ç³»ç»Ÿ
db.dialet = mysql
# ä¸»æœº
db.host = localhost
# ç«¯å£
db.port = 3306
# ç”¨æˆ·å
db.username = root
# å¯†ç 
db.password =
# æ•°æ®åº“
db.database =

# ä¸‹é¢æ˜¯ foo ä¸šåŠ¡è¦ç”¨åˆ°çš„è¡¨
foo.table = relation
```

ç›®å‰å®ç°äº† 4 ä¸ªå­å‘½ä»¤ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

### 1. **get** å‘½ä»¤

å‘½ä»¤å¸®åŠ©ä¿¡æ¯å¦‚ä¸‹ï¼š

```shell
$ python config_props.py get -h
usage: config_props.py get [-h] [-t {raw,wild,re}] [-s SIGN]
                           path pattern [pattern ...]

positional arguments:
  path                  é…ç½®æ–‡ä»¶è·¯å¾„
  pattern               å±æ€§åæˆ–æ¨¡å¼

optional arguments:
  -h, --help            show this help message and exit
  -t {raw,wild,re}, --type {raw,wild,re}
                        å±æ€§åä½œä¸ºä»€ä¹ˆæ¨¡å¼å¤„ç†ï¼š
                            raw(é»˜è®¤): è§†ä¸ºæ™®é€šå­—ç¬¦ä¸²ï¼›
                            wild: è§†ä¸º unix é€šé…ç¬¦æ¨¡å¼ï¼›
                            re: è§†ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ã€‚
  -s SIGN, --sign SIGN  å±æ€§å’Œå€¼çš„åˆ†ç•Œï¼Œå¿…é¡»æ˜¯å•ä¸ªå­—ç¬¦ï¼Œé»˜è®¤ä¸º =
  -e ENCODING, --encoding ENCODING
                        é…ç½®æ–‡ä»¶çš„ç¼–ç 
```

ä½¿ç”¨åç§°æœç´¢ï¼š

```shell
$ python config_props.py get example.properties db.dialet foo.table non.exists.name
db.dialet = mysql
foo.table = relation
```

ä½¿ç”¨ unix è·¯å¾„é€šé…ç¬¦æ¨¡å¼æœç´¢ï¼š

```shell
$ python config_props.py get example.properties 'db.*' -t wild
db.dialet = mysql
db.host = localhost
db.port = 3306
db.username = root
db.password =
db.database =
```

ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æœç´¢ï¼š

```shell
$ python config_props.py get example.properties 'db\..*' -t re
db.dialet = mysql
db.host = localhost
db.port = 3306
db.username = root
db.password =
db.database =
```

### 2. **set** å‘½ä»¤

å‘½ä»¤å¸®åŠ©ä¿¡æ¯å¦‚ä¸‹ï¼š

```shell
$ python config_props.py set -h
usage: config_props.py set [-h] [-s SIGN] path name value [name value ...]

positional arguments:
  path                  é…ç½®æ–‡ä»¶è·¯å¾„
  name value            å±æ€§åå’Œå±æ€§å€¼çš„å¯¹å¶ï¼Œæ­¤å‚æ•°å¿…é¡»ä¼ å¶æ•°ä¸ª

optional arguments:
  -h, --help            show this help message and exit
  -s SIGN, --sign SIGN  å±æ€§å’Œå€¼çš„åˆ†ç•Œï¼Œå¿…é¡»æ˜¯å•ä¸ªå­—ç¬¦ï¼Œé»˜è®¤ä¸º =
  -e ENCODING, --encoding ENCODING
                        é…ç½®æ–‡ä»¶çš„ç¼–ç 
```

æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š

```shell
$ python config_props.py set example.properties db.password 123456 db.database test foo.bar ğŸ˜‚ğŸ¤£ğŸ˜†ğŸ˜…
Updated: db.password =
      => db.password=123456
Updated: db.database =
      => db.database=test
Inserted: foo.bar
      => foo.bar=ğŸ˜‚ğŸ¤£ğŸ˜†ğŸ˜…
```

é…ç½®æ–‡ä»¶ `example.properties` è¢«æ›´æ–°ä¸ºï¼š

```ini example.properties
## ä»¥ä¸‹æ˜¯æ•°æ®åº“è¿æ¥ä¿¡æ¯

# æ•°æ®åº“ç³»ç»Ÿ
db.dialet = mysql
# ä¸»æœº
db.host = localhost
# ç«¯å£
db.port = 3306
# ç”¨æˆ·å
db.username = root
# å¯†ç 
db.password=123456
# æ•°æ®åº“
db.database=test

# ä¸‹é¢æ˜¯ foo ä¸šåŠ¡è¦ç”¨åˆ°çš„è¡¨
foo.table = relation
foo.bar=ğŸ˜‚ğŸ¤£ğŸ˜†ğŸ˜…

```

### 3. **del** å‘½ä»¤

å‘½ä»¤å¸®åŠ©ä¿¡æ¯å¦‚ä¸‹ï¼š

```shell
$ python config_props.py del -h
usage: config_props.py del [-h] [-t {raw,wild,re}] [-s SIGN]
                           path pattern [pattern ...]

positional arguments:
  path                  é…ç½®æ–‡ä»¶è·¯å¾„
  pattern               å±æ€§åæˆ–æ¨¡å¼

optional arguments:
  -h, --help            show this help message and exit
  -t {raw,wild,re}, --type {raw,wild,re}
                        å±æ€§åä½œä¸ºä»€ä¹ˆæ¨¡å¼å¤„ç†ï¼š
                            raw(é»˜è®¤): è§†ä¸ºæ™®é€šå­—ç¬¦ä¸²ï¼›
                            wild: è§†ä¸º unix é€šé…ç¬¦æ¨¡å¼ï¼›
                            re: è§†ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ã€‚
  -s SIGN, --sign SIGN  å±æ€§å’Œå€¼çš„åˆ†ç•Œï¼Œå¿…é¡»æ˜¯å•ä¸ªå­—ç¬¦ï¼Œé»˜è®¤ä¸º =
  -e ENCODING, --encoding ENCODING
                        é…ç½®æ–‡ä»¶çš„ç¼–ç 
```

æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š

```shell
$ python config_props.py del example.properties foo.bar foo.baz
Deleted: foo.bar
      <= foo.bar=ğŸ˜‚ğŸ¤£ğŸ˜†ğŸ˜…
```

é…ç½®æ–‡ä»¶ `example.properties` è¢«æ›´æ–°ä¸ºï¼š

```ini example.properties
## ä»¥ä¸‹æ˜¯æ•°æ®åº“è¿æ¥ä¿¡æ¯

# æ•°æ®åº“ç³»ç»Ÿ
db.dialet = mysql
# ä¸»æœº
db.host = localhost
# ç«¯å£
db.port = 3306
# ç”¨æˆ·å
db.username = root
# å¯†ç 
db.password=123456
# æ•°æ®åº“
db.database=test

# ä¸‹é¢æ˜¯ foo ä¸šåŠ¡è¦ç”¨åˆ°çš„è¡¨
foo.table = relation

```

### 4. **uplines** å‘½ä»¤

å‘½ä»¤å¸®åŠ©ä¿¡æ¯å¦‚ä¸‹ï¼š

```shell
$ python config_props.py uplines -h
usage: config_props.py uplines [-h] [-s SIGN] path line [line ...]

positional arguments:
  path                  é…ç½®æ–‡ä»¶è·¯å¾„
  line                  å½¢å¦‚ï¼š
                            1. name: åˆ é™¤åç§°æ˜¯nameçš„å±æ€§ï¼›
                            2. name=value: æ›´æ–°åç§°æ˜¯nameçš„å±æ€§ã€‚

optional arguments:
  -h, --help            show this help message and exit
  -s SIGN, --sign SIGN  å±æ€§å’Œå€¼çš„åˆ†ç•Œï¼Œå¿…é¡»æ˜¯å•ä¸ªå­—ç¬¦ï¼Œé»˜è®¤ä¸º =
  -e ENCODING, --encoding ENCODING
                        é…ç½®æ–‡ä»¶çš„ç¼–ç 
```

æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š

```shell
$ python config_props.py uplines example.properties db.username=test db.password=randomXYZ foo.table foo.bar
Updated: db.username = root
      => db.username=test
Updated: db.password=123456
      => db.password=randomXYZ
Deleted: foo.table
      <= foo.table = relation
ğŸ˜‚ ignored: foo.bar
```

é…ç½®æ–‡ä»¶ `example.properties` è¢«æ›´æ–°ä¸ºï¼š

```ini example.properties
## ä»¥ä¸‹æ˜¯æ•°æ®åº“è¿æ¥ä¿¡æ¯

# æ•°æ®åº“ç³»ç»Ÿ
db.dialet = mysql
# ä¸»æœº
db.host = localhost
# ç«¯å£
db.port = 3306
# ç”¨æˆ·å
db.username=test
# å¯†ç 
db.password=randomXYZ
# æ•°æ®åº“
db.database=test

# ä¸‹é¢æ˜¯ foo ä¸šåŠ¡è¦ç”¨åˆ°çš„è¡¨

```

## æœªæ¥è§„åˆ’

å…¶å®æˆ‘æ—©å°±å®Œæˆäº†ï¼Œå¢åˆ æ”¹æŸ¥å…¶ä»–æ ¼å¼é…ç½®æ–‡ä»¶çš„å‘½ä»¤è¡Œè„šæœ¬ï¼Œè¯¸å¦‚ï¼š

- [.config,.cnf,.conf,.cfg,.cg,.ini](https://docs.python.org/3/library/configparser.html)
- [JSON](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON)
- [XML](https://www.w3.org/standards/xml/)
- [YAML](https://yaml.org/)
- [TOML](https://toml.io)

ä½†å®ç°å¾—éƒ½æ¯”è¾ƒå¤æ‚ï¼Œå¹¶ä¸”è¿˜ç”¨åˆ°äº†ä¸€äº›ç¬¬ä¸‰æ–¹åº“ï¼Œè€Œä¸”åœ¨æˆ‘çœ‹æ¥è¿˜ä¸å¤Ÿå®Œå–„ã€‚æˆ‘æ‰“ç®—ä¸ºå®ƒä»¬è®¾è®¡å¹¶å®ç°ä¸€ä¸ªç»Ÿä¸€çš„æ“ä½œæ–¹æ¡ˆï¼Œæä¾›ç±»ä¼¼ [XQuery](https://www.w3.org/XML/Query/)
 æˆ– [SQL](https://en.m.wikipedia.org/wiki/SQL)
  çš„å¢åˆ æ”¹æŸ¥ï¼Œç„¶åå†åˆ†äº«å‡ºæ¥ï¼Œæ•¬è¯·æœŸå¾…åç»­æ–‡ç« ã€‚

